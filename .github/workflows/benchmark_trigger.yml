name: Benchmark - Trigger

on:
  issue_comment:
    types: [ created ]
jobs:
  trigger:
    runs-on: ubuntu-latest
    permissions:
      pull-requests: write
    steps:
    - name: Check Benchmark Trigger
      uses: khan/pull-request-comment-trigger@master
      with:
        trigger: '/benchmark'
        reaction: eyes
      env:
        GITHUB_TOKEN: '${{ secrets.GITHUB_TOKEN }}'

    - name: Start Benchmark
      if: steps.check.outputs.triggered == 'true'
      run: |
        curl \
          -X POST \
          -H "Accept: application/vnd.github.v3+json" \
          -H "Authorization: Bearer ${{ secrets.GITHUB_TOKEN }}" \
          https://api.github.com/repos/FileOnQ/Imaging.Raw/actions/workflows/benchmark.yml/dispatches \
          -d '{"ref":"${{ github.REF }}"}'
